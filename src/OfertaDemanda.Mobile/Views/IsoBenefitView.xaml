<?xml version="1.0" encoding="UTF-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.Maui;assembly=LiveChartsCore.SkiaSharpView.Maui"
             x:Class="OfertaDemanda.Mobile.Views.IsoBenefitView"
             x:Name="Root">
  <Grid RowDefinitions="Auto,*" RowSpacing="12">
    <ScrollView Grid.Row="0">
      <VerticalStackLayout Spacing="10">
        <Label Text="{Binding Localization[IsoBenefit_MarketParams_Title]}" FontSize="18" FontAttributes="Bold" />
        <Label Text="{Binding Localization[IsoBenefit_MarketDemand_Label]}" FontAttributes="Bold" />
        <Entry Text="{Binding DemandExpression}" />

        <Label Text="{Binding Localization[IsoBenefit_DemandShock_Label]}" FontAttributes="Bold" />
        <Slider Minimum="-40" Maximum="40" Value="{Binding DemandShock}" />
        <Label Text="{Binding DemandShockText}" FontSize="12" />

        <Label Text="{Binding Localization[IsoBenefit_Firms_Title]}" FontSize="16" FontAttributes="Bold" />
        <HorizontalStackLayout Spacing="8">
          <Button Text="{Binding Localization[IsoBenefit_AddFirm]}" Command="{Binding AddFirmCommand}" />
          <Button Text="{Binding Localization[IsoBenefit_RemoveFirm]}" Command="{Binding RemoveFirmCommand}" />
        </HorizontalStackLayout>
        <CollectionView ItemsSource="{Binding Firms}" SelectionMode="Single" SelectedItem="{Binding SelectedFirm}">
          <CollectionView.ItemTemplate>
            <DataTemplate>
              <VerticalStackLayout Spacing="4" Padding="0,4">
                <Entry Text="{Binding Name}" Placeholder="{Binding Source={x:Reference Root}, Path=BindingContext.Localization[IsoBenefit_FirmName_Placeholder]}" />
                <Entry Text="{Binding CostExpression}" Placeholder="{Binding Source={x:Reference Root}, Path=BindingContext.Localization[IsoBenefit_FirmCost_Placeholder]}" />
              </VerticalStackLayout>
            </DataTemplate>
          </CollectionView.ItemTemplate>
        </CollectionView>

        <Label Text="{Binding Localization[IsoBenefit_Reference_Title]}" FontSize="16" FontAttributes="Bold" />
        <Label Text="{Binding ReferencePriceText}" />
        <Label Text="{Binding ReferenceQuantityText}" />
        <Label Text="{Binding PriceNoteText}" FontSize="12" />

        <Frame IsVisible="{Binding HasErrors}" BackgroundColor="#FFF0F0" Padding="8" CornerRadius="6">
          <VerticalStackLayout>
            <Label Text="{Binding Localization[Common_Errors]}" FontAttributes="Bold" />
            <CollectionView ItemsSource="{Binding Errors}">
              <CollectionView.ItemTemplate>
                <DataTemplate>
                  <Label Text="â€¢ {Binding .}" />
                </DataTemplate>
              </CollectionView.ItemTemplate>
            </CollectionView>
          </VerticalStackLayout>
        </Frame>

        <Label Text="{Binding Localization[IsoBenefit_Status_Title]}" FontSize="16" FontAttributes="Bold" />
        <CollectionView ItemsSource="{Binding FirmStatuses}">
          <CollectionView.ItemTemplate>
            <DataTemplate>
              <VerticalStackLayout Spacing="2">
                <Label Text="{Binding Name}" FontAttributes="Bold" />
                <Label Text="{Binding Summary}" />
                <Label Text="{Binding Details}" FontSize="12" Opacity="0.8" />
              </VerticalStackLayout>
            </DataTemplate>
          </CollectionView.ItemTemplate>
        </CollectionView>

        <Frame Padding="10" CornerRadius="6" BackgroundColor="{AppThemeBinding Light=#F3F4F6, Dark=#1E1E1E}">
          <VerticalStackLayout>
            <Label Text="{Binding Localization[IsoBenefit_Theory_Title]}" FontSize="16" FontAttributes="Bold" />
            <Label Text="{Binding TheoryText}" FontSize="12" />
          </VerticalStackLayout>
        </Frame>
      </VerticalStackLayout>
    </ScrollView>

    <lvc:CartesianChart Grid.Row="1"
                        Series="{Binding Series}"
                        XAxes="{Binding XAxes}"
                        YAxes="{Binding YAxes}"
                        LegendPosition="Right" />
  </Grid>
</ContentView>
